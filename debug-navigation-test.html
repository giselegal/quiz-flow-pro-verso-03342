<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Teste de Navega√ß√£o - Quiz Quest</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 20px;
            background: #FAF9F7;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #B89B7A;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.2s;
        }
        .test-button:hover {
            background: #A0895B;
            transform: translateY(-2px);
        }
        .test-result {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            font-family: monospace;
            font-size: 14px;
        }
        .success { border-left: 4px solid #28a745; }
        .error { border-left: 4px solid #dc3545; }
        .info { border-left: 4px solid #007bff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Diagn√≥stico de Navega√ß√£o - Quiz Quest</h1>
        <p><strong>Objetivo:</strong> Verificar se a navega√ß√£o do `/admin/funis` para `/editor` est√° funcionando corretamente.</p>

        <div class="test-section">
            <h2>üß™ Testes de Navega√ß√£o</h2>
            
            <button class="test-button" onclick="testDirectNavigation()">
                üìç Teste 1: Navega√ß√£o Direta
            </button>
            
            <button class="test-button" onclick="testParameterNavigation()">
                üéØ Teste 2: Navega√ß√£o com Par√¢metros
            </button>
            
            <button class="test-button" onclick="testCurrentLocation()">
                üìç Teste 3: Verificar URL Atual
            </button>

            <button class="test-button" onclick="testAdminFunis()">
                üìä Teste 4: Ir para Admin/Funis
            </button>

            <button class="test-button" onclick="simulateFunnelClick()">
                üé® Teste 5: Simular Clique em Template
            </button>
        </div>

        <div id="results"></div>

        <div class="test-section" style="margin-top: 40px;">
            <h2>üîß Informa√ß√µes do Sistema</h2>
            <div class="test-result info">
                <strong>URL Base:</strong> <span id="baseUrl"></span><br>
                <strong>Location:</strong> <span id="currentLocation"></span><br>
                <strong>User Agent:</strong> <span id="userAgent"></span>
            </div>
        </div>
    </div>

    <script>
        // Inicializa√ß√£o
        document.getElementById('baseUrl').textContent = window.location.origin;
        document.getElementById('currentLocation').textContent = window.location.href;
        document.getElementById('userAgent').textContent = navigator.userAgent;

        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            results.appendChild(div);
        }

        function testDirectNavigation() {
            addResult('üöÄ Iniciando teste de navega√ß√£o direta para /editor');
            
            try {
                const testUrl = '/editor';
                addResult(`üìç URL de teste: ${testUrl}`, 'info');
                
                // Simular navega√ß√£o
                setTimeout(() => {
                    window.location.href = testUrl;
                }, 1000);
                
                addResult('‚úÖ Navega√ß√£o iniciada com sucesso', 'success');
            } catch (error) {
                addResult(`‚ùå Erro na navega√ß√£o: ${error.message}`, 'error');
            }
        }

        function testParameterNavigation() {
            addResult('üéØ Testando navega√ß√£o com par√¢metros');
            
            try {
                const funnelId = `test-funnel-${Date.now()}`;
                const templateId = 'quiz-estilo-21-steps';
                const testUrl = `/editor/${funnelId}?template=${templateId}`;
                
                addResult(`üìç URL de teste: ${testUrl}`, 'info');
                addResult(`üÜî Funnel ID: ${funnelId}`, 'info');
                addResult(`üé® Template ID: ${templateId}`, 'info');
                
                setTimeout(() => {
                    window.location.href = testUrl;
                }, 1000);
                
                addResult('‚úÖ Navega√ß√£o com par√¢metros iniciada', 'success');
            } catch (error) {
                addResult(`‚ùå Erro na navega√ß√£o com par√¢metros: ${error.message}`, 'error');
            }
        }

        function testCurrentLocation() {
            addResult('üìç Verificando informa√ß√µes da URL atual');
            
            try {
                addResult(`üåê Origin: ${window.location.origin}`, 'info');
                addResult(`üìÑ Pathname: ${window.location.pathname}`, 'info');
                addResult(`üîó Search: ${window.location.search}`, 'info');
                addResult(`#Ô∏è‚É£ Hash: ${window.location.hash}`, 'info');
                addResult(`üìç Full URL: ${window.location.href}`, 'info');
                
                // Testar se √© um SPA
                const isSPA = document.querySelector('script[src*="main"]') || 
                             document.querySelector('script[src*="index"]') ||
                             document.querySelector('div[id="root"]');
                addResult(`üéØ SPA Detectado: ${isSPA ? 'SIM' : 'N√ÉO'}`, isSPA ? 'success' : 'error');
                
            } catch (error) {
                addResult(`‚ùå Erro ao verificar location: ${error.message}`, 'error');
            }
        }

        function testAdminFunis() {
            addResult('üìä Testando navega√ß√£o para /admin/funis');
            
            try {
                const testUrl = '/admin/funis';
                addResult(`üìç URL de destino: ${testUrl}`, 'info');
                
                setTimeout(() => {
                    window.location.href = testUrl;
                }, 1000);
                
                addResult('‚úÖ Redirecionando para admin/funis', 'success');
            } catch (error) {
                addResult(`‚ùå Erro ao navegar para admin/funis: ${error.message}`, 'error');
            }
        }

        function simulateFunnelClick() {
            addResult('üé® Simulando clique em template de funil');
            
            try {
                // Simular o mesmo comportamento do FunnelPanelPage
                const templateId = 'quiz-estilo-21-steps';
                const funnelId = `funnel-${templateId}-${Date.now()}`;
                const editorUrl = `/editor/${encodeURIComponent(funnelId)}?template=${templateId}`;
                
                addResult(`üé® Template ID: ${templateId}`, 'info');
                addResult(`üÜî Funnel ID Gerado: ${funnelId}`, 'info');
                addResult(`üîó URL do Editor: ${editorUrl}`, 'info');
                
                // Simular salvamento no localStorage
                const funnelData = {
                    id: funnelId,
                    name: `Quiz Template - ${new Date().toLocaleTimeString()}`,
                    status: 'draft',
                    updatedAt: new Date().toISOString(),
                    templateId: templateId
                };
                
                try {
                    localStorage.setItem(`funnel-${funnelId}`, JSON.stringify(funnelData));
                    addResult('üíæ Dados do funil salvos no localStorage', 'success');
                } catch (storageError) {
                    addResult(`‚ö†Ô∏è Erro ao salvar no localStorage: ${storageError.message}`, 'error');
                }
                
                addResult('üöÄ Iniciando navega√ß√£o...', 'info');
                
                setTimeout(() => {
                    window.location.href = editorUrl;
                }, 1500);
                
                addResult('‚úÖ Simula√ß√£o de clique em template conclu√≠da', 'success');
                
            } catch (error) {
                addResult(`‚ùå Erro na simula√ß√£o de clique: ${error.message}`, 'error');
            }
        }

        // Log inicial
        addResult('üîç Diagn√≥stico de navega√ß√£o inicializado', 'success');
        addResult(`üìç P√°gina atual: ${window.location.pathname}`, 'info');
    </script>
</body>
</html>
