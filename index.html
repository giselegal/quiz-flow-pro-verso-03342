<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸš€ Quiz Flow Pro Verso | Vista-se de VocÃª! - Gisele GalvÃ£o</title>
  <meta name="description" content="Descubra seu estilo pessoal Ãºnico com nosso quiz interativo." />
  <!-- ðŸ›¡ï¸ CSP: PolÃ­tica de seguranÃ§a de conteÃºdo
       - Em DEV (localhost) relaxamos para permitir blob: (SharedWorker / HMR), unsafe-eval e ws
       - Em PRODUÃ‡ÃƒO mantemos regras mais restritas sem blob: script nem unsafe-eval
       ObservaÃ§Ã£o: Vite usa SharedWorker/Blob URLs; sem blob: em worker-src/script-src ocorre SecurityError. -->
  <script>
    (function applyDynamicCSP() {
      var isLocal = /localhost|127\.0\.0\.1/.test(location.hostname);
      var prodPolicy = "default-src 'self'; script-src 'self' 'unsafe-inline' https://fonts.googleapis.com; script-src-elem 'self' 'unsafe-inline' https://fonts.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://*.supabase.co https://quiz-flow-pro-verso-03342.onrender.com https://fonts.googleapis.com https://fonts.gstatic.com; img-src 'self' data: https://res.cloudinary.com; frame-src 'self'; media-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; manifest-src 'self'; worker-src 'self';";
      var devPolicy = "default-src 'self' blob: data:; script-src 'self' 'unsafe-inline' 'unsafe-eval' blob: https://fonts.googleapis.com; script-src-elem 'self' 'unsafe-inline' https://fonts.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; connect-src 'self' blob: data: ws: wss: http: https: https://*.supabase.co https://quiz-flow-pro-verso-03342.onrender.com https://fonts.googleapis.com https://fonts.gstatic.com; img-src 'self' data: blob: https://res.cloudinary.com; frame-src 'self'; media-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; manifest-src 'self'; worker-src 'self' blob:;";
      var meta = document.createElement('meta');
      meta.httpEquiv = 'Content-Security-Policy';
      meta.content = isLocal ? devPolicy : prodPolicy;
      document.head.appendChild(meta);
      console.log('[CSP] Aplicada polÃ­tica', isLocal ? 'DEV (relaxada)' : 'PROD (restrita)');
    })();
  </script>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#4F46E5">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />
  <!-- Carregar CSS principal diretamente para evitar cancelamentos de HMR -->
  <link rel="stylesheet" href="/src/index.css" />
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
    }

    #root {
      min-height: 100vh;
      width: 100%;
    }
  </style>
</head>

<body>
  <div id="root"></div>
  <!-- âŒ DESATIVADO: Conflito com SupabaseInterceptor.ts (TypeScript) -->
  <!-- <script src="/supabase-fallback-system.js" type="text/javascript"></script> -->
  <!-- ðŸ”§ POLYFILLS ROBUSTOS: Garantir compatibilidade total -->
  <script>
    (function () {
      // 1. TypeScript __assign helper (usado por libs compiladas)
      if (typeof window.__assign !== 'function') {
        console.log('ðŸ”§ Injetando polyfill __assign');
        window.__assign = Object.assign || function (target) {
          for (var i = 1; i < arguments.length; i++) {
            var source = arguments[i];
            for (var key in source) {
              if (Object.prototype.hasOwnProperty.call(source, key)) {
                target[key] = source[key];
              }
            }
          }
          return target;
        };
      }

      // 2. TypeScript __rest helper  
      if (typeof window.__rest !== 'function') {
        window.__rest = function (source, excluded) {
          var target = {};
          for (var key in source) {
            if (Object.prototype.hasOwnProperty.call(source, key) && excluded.indexOf(key) < 0) {
              target[key] = source[key];
            }
          }
          return target;
        };
      }

      // 3. TypeScript __spreadArray helper
      if (typeof window.__spreadArray !== 'function') {
        window.__spreadArray = function (to, from, pack) {
          if (pack || arguments.length === 2) {
            for (var i = 0, l = from.length, ar; i < l; i++) {
              if (ar || !(i in from)) {
                if (!ar) ar = Array.prototype.slice.call(from, 0, i);
                ar[i] = from[i];
              }
            }
          }
          return to.concat(ar || Array.prototype.slice.call(from));
        };
      }

      // 4. Garantir que globalThis existe (para compatibility)
      if (typeof globalThis === 'undefined') {
        window.globalThis = window;
      }

      console.log('âœ… Polyfills TypeScript carregados com sucesso');
    })();
  </script>
  <script type="module" src="/src/main.tsx"></script>
</body>

</html>