{
  "sources": [
    "src/config/optimized21StepsFunnel.ts",
    "src/templates/quiz21StepsComplete.ts",
    "src/config/quizStepsComplete.ts (não analisado)"
  ],
  "summary": {
    "status": "initial",
    "notes": [
      "Optimized usa questionData e options[].score (mapa estilo→pontos)",
      "Template usa options-grid com ids prefixados (ex: natural_q1) e properties.scoreValues",
      "Ambos expressam pontuação por estilo, porém com formatos diferentes",
      "Etapas estratégicas (13–18) no optimized usam 'segment' em vez de 'score'",
      "Template estratégico usa ids q13_opt1.. sem 'segment' explícito"
    ]
  },
  "differences": [
    {
      "area": "question/options schema",
      "optimized": "questionData com options[].score como mapa de estilos",
      "template": "block options-grid com options ids prefixados e properties.scoreValues",
      "impact": "Calculadora deve aceitar ambos ou usar adapter para formato canônico"
    },
    {
      "area": "strategic questions",
      "optimized": "options incluem 'segment'",
      "template": "ids q13_opt1.. sem 'segment'",
      "impact": "Adapter mapeia ids para 'segment' opcional no canônico"
    },
    {
      "area": "images",
      "optimized": "exibe imagens por step; options podem não ter imageUrl",
      "template": "options incluem imageUrl nas etapas visuais",
      "impact": "Canonical deve permitir imageUrl por opção"
    }
  ],
  "canonicalProposal": {
    "Question": {
      "id": "string",
      "title": "string",
      "text": "string",
      "kind": "scored|strategic",
      "options": [
        {
          "id": "string",
          "text": "string",
          "imageUrl": "string opcional",
          "score": "mapa estilo→pontos (opcional)",
          "segment": "string opcional"
        }
      ]
    }
  }
}
{
  "summary": "Diff inicial entre fontes: optimized config x template completo",
  "differences": [
    {
      "area": "option_id_style",
      "optimized": "options use neutral ids 'a','b','c' with score object mapping styles",
      "template": "options use style-prefixed ids like 'natural_q1','classico_q1' and separate scoreValues mapping in properties",
      "impact": "ResultEngine expects either prefix-based ids or score objects — mismatch leads to no scoring in some cases",
      "priority": "high"
    },
    {
      "area": "selection_count_enforcement",
      "optimized": "questionData.options define scores directly and may use selectionMode single/multiple",
      "template": "properties.requiredSelections and max/min selections enforced in options-grid; scoring uses scoreValues mapping",
      "impact": "Enforcement and scoring location differ; adapters must normalize requiredSelections into schema",
      "priority": "medium"
    },
    {
      "area": "images",
      "optimized": "image urls embedded in options or properties",
      "template": "images present on block properties and content with different keys (imageUrl/src)",
      "impact": "UI blocks must support both 'imageUrl' and 'src' keys or adapters should normalize",
      "priority": "low"
    }
  ],
  "samples": [
    "reports/samples/optimized_step2.json",
    "reports/samples/template_step2.json"
  ]
}
