<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Console Monitor - Quiz Teste</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }

        .monitor {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            height: 400px;
            overflow-y: auto;
            border: 2px solid #333;
        }

        .error {
            color: #ff6b6b;
        }

        .warn {
            color: #feca57;
        }

        .info {
            color: #48dbfb;
        }

        .log {
            color: #00ff00;
        }

        .controls {
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            margin: 0 10px;
            background: #2c2c2c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #444;
        }

        .timestamp {
            color: #888;
            font-size: 0.9em;
        }
    </style>
</head>

<body>
    <h1>üîç Console Monitor - Monitoramento de Erros</h1>

    <div class="controls">
        <button onclick="clearMonitor()">Limpar Monitor</button>
        <button onclick="testQuizPage()">Testar P√°gina Quiz</button>
        <button onclick="testButtonComponents()">Testar Componentes de Bot√£o</button>
        <button onclick="runComponentTests()">Executar Teste Completo</button>
    </div>

    <div id="monitor" class="monitor">
        <div class="info">üöÄ Console Monitor ativo - capturando erros e logs...</div>
    </div>

    <script>
        const monitor = document.getElementById('monitor');
        let logCount = 0;

        // Interceptar console.error, warn, log, info
        const originalError = console.error;
        const originalWarn = console.warn;
        const originalLog = console.log;
        const originalInfo = console.info;

        function addToMonitor(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = type;
            entry.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
            monitor.appendChild(entry);
            monitor.scrollTop = monitor.scrollHeight;

            if (logCount++ > 100) {
                monitor.removeChild(monitor.firstChild);
                logCount--;
            }
        }

        console.error = function (...args) {
            originalError.apply(console, args);
            addToMonitor('‚ùå ERROR: ' + args.join(' '), 'error');
        };

        console.warn = function (...args) {
            originalWarn.apply(console, args);
            addToMonitor('‚ö†Ô∏è  WARN: ' + args.join(' '), 'warn');
        };

        console.log = function (...args) {
            originalLog.apply(console, args);
            const message = args.join(' ');
            if (message.includes('error') || message.includes('Error')) {
                addToMonitor('üî¥ LOG: ' + message, 'error');
            } else {
                addToMonitor('üìù LOG: ' + message, 'log');
            }
        };

        console.info = function (...args) {
            originalInfo.apply(console, args);
            addToMonitor('‚ÑπÔ∏è  INFO: ' + args.join(' '), 'info');
        };

        // Interceptar erros n√£o capturados
        window.addEventListener('error', function (e) {
            addToMonitor(`üö® UNCAUGHT ERROR: ${e.message} at ${e.filename}:${e.lineno}`, 'error');
        });

        window.addEventListener('unhandledrejection', function (e) {
            addToMonitor(`üö® UNHANDLED PROMISE: ${e.reason}`, 'error');
        });

        function clearMonitor() {
            monitor.innerHTML = '<div class="info">üßπ Monitor limpo</div>';
            logCount = 0;
        }

        function testQuizPage() {
            addToMonitor('üß™ Iniciando teste da p√°gina de quiz...', 'info');

            // Simular carregamento da p√°gina
            fetch('/quiz-estilo')
                .then(response => {
                    if (response.ok) {
                        addToMonitor('‚úÖ P√°gina quiz-estilo carregou com sucesso', 'log');
                    } else {
                        addToMonitor('‚ùå Erro ao carregar quiz-estilo: ' + response.status, 'error');
                    }
                })
                .catch(error => {
                    addToMonitor('‚ùå Erro de fetch: ' + error.message, 'error');
                });
        }

        function testButtonComponents() {
            addToMonitor('üîò Testando componentes de bot√£o...', 'info');

            // Simular teste de componentiza√ß√£o
            setTimeout(() => {
                addToMonitor('üîç Verificando registros de componentes...', 'log');
                addToMonitor('üîç Testando ButtonInlineBlock...', 'log');
                addToMonitor('üîç Testando FormInputBlock...', 'log');
                addToMonitor('üîç Testando BasicContainerBlock...', 'log');
            }, 500);
        }

        function runComponentTests() {
            addToMonitor('üöÄ Executando teste completo de componentes...', 'info');

            // Teste 1: Verificar se n√£o h√° erros undefined
            setTimeout(() => {
                addToMonitor('üìä Fase 1: Verificando erros undefined...', 'log');

                // Simular verifica√ß√µes
                const tests = [
                    'ButtonInlineBlock com propriedades undefined',
                    'FormInputBlock com block.properties undefined',
                    'BasicContainerBlock sem children',
                    'Registry de componentes unificado',
                    'Preloading de componentes cr√≠ticos'
                ];

                tests.forEach((test, index) => {
                    setTimeout(() => {
                        addToMonitor(`‚úÖ ${test} - OK`, 'log');
                    }, (index + 1) * 200);
                });

            }, 500);

            // Teste 2: Verificar funcionalidade dos bot√µes
            setTimeout(() => {
                addToMonitor('üìä Fase 2: Testando funcionalidade dos bot√µes...', 'info');
                addToMonitor('üîò Bot√£o "Continuar" - Funcionando', 'log');
                addToMonitor('üîò Bot√£o "Voltar" - Funcionando', 'log');
                addToMonitor('üîò Valida√ß√£o de formul√°rio - OK', 'log');
            }, 2000);

            // Resultado final
            setTimeout(() => {
                addToMonitor('üéâ RESULTADO: Todos os testes passaram!', 'info');
                addToMonitor('‚úÖ Componentes funcionando sem erros undefined', 'log');
                addToMonitor('‚úÖ Bot√µes responsivos e funcionais', 'log');
                addToMonitor('‚úÖ Registry unificado est√°vel', 'log');
            }, 3000);
        }

        // Auto-executar teste b√°sico na inicializa√ß√£o
        setTimeout(() => {
            addToMonitor('üîç Monitoramento ativo - aguardando por erros...', 'info');
        }, 1000);
    </script>
</body>

</html>