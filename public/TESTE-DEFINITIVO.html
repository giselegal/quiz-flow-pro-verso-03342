<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ðŸ”¥ TESTE DEFINITIVO</title>
    <script>
        console.log('ðŸ”¥ ==========================================');
        console.log('ðŸ”¥ TESTE DEFINITIVO - PROPERTIES PANEL');
        console.log('ðŸ”¥ ==========================================');
        
        // 1. ATIVAR FLAG
        const chave = 'qm-editor:use-simple-properties';
        localStorage.setItem(chave, 'true');
        console.log('âœ… 1. Flag ativada:', chave, '=', localStorage.getItem(chave));
        
        // 2. INTERCEPTAR CONSOLE
        const logs = [];
        const originalLog = console.log;
        console.log = function(...args) {
            const msg = args.map(a => typeof a === 'object' ? JSON.stringify(a, null, 2) : String(a)).join(' ');
            logs.push('[LOG] ' + msg);
            originalLog.apply(console, args);
        };
        
        const originalError = console.error;
        console.error = function(...args) {
            const msg = args.map(a => typeof a === 'object' ? JSON.stringify(a, null, 2) : String(a)).join(' ');
            logs.push('[ERROR] ' + msg);
            originalError.apply(console, args);
        };
        
        console.log('âœ… 2. Console interceptado');
        
        // 3. VERIFICAR APÃ“S CARREGAMENTO
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('ðŸ” 3. Verificando estado apÃ³s 5 segundos...');
                
                // Exportar logs
                const logText = logs.join('\n');
                console.log('ðŸ“Š Total de logs capturados:', logs.length);
                
                // Salvar logs
                window.capturedLogs = logs;
                
                // Mostrar resumo
                const pontosCegos = logs.filter(l => l.includes('PONTO CEGO'));
                if (pontosCegos.length > 0) {
                    console.error('âŒ PONTOS CEGOS DETECTADOS:', pontosCegos.length);
                    pontosCegos.forEach(pc => console.error('  ', pc));
                }
                
                const showProperties = logs.filter(l => l.includes('showProperties'));
                console.log('ðŸ” Logs com showProperties:', showProperties.length);
                showProperties.forEach(sp => console.log('  ', sp));
                
            }, 5000);
        });
        
        // 4. REDIRECIONAR
        console.log('ðŸš€ 4. Redirecionando para editor...');
        setTimeout(() => {
            window.location.href = '/editor?template=quiz21StepsComplete';
        }, 1000);
    </script>
</head>
<body style="background:#000;color:#0f0;font-family:monospace;padding:50px;text-align:center;">
    <h1>ðŸ”¥ REDIRECIONANDO...</h1>
    <p>Aguarde. Logs serÃ£o capturados.</p>
    <hr>
    <p style="font-size:12px;">
        ApÃ³s carregar o editor:<br>
        1. Abra o console (F12)<br>
        2. Procure por logs "PONTO CEGO"<br>
        3. Verifique se showProperties = true<br>
        4. Clique em um bloco<br>
        5. Verifique se Properties Panel aparece
    </p>
</body>
</html>
