<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Teste Real - Editor V1 Regras</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h1 class="text-2xl font-bold text-amber-800 mb-4">üß™ Teste Real - Editor V1 Regras</h1>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-800">üìã Checklist de Verifica√ß√£o</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="check1" class="w-4 h-4 text-amber-500">
                            <label for="check1">HybridTemplateService funcionando</label>
                        </div>
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="check2" class="w-4 h-4 text-amber-500">
                            <label for="check2">Detec√ß√£o autom√°tica de colunas</label>
                        </div>
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="check3" class="w-4 h-4 text-amber-500">
                            <label for="check3">Bordas douradas nas sele√ß√µes</label>
                        </div>
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="check4" class="w-4 h-4 text-amber-500">
                            <label for="check4">1 coluna para texto-only</label>
                        </div>
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="check5" class="w-4 h-4 text-amber-500">
                            <label for="check5">2 colunas para imagem+texto</label>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-800">üîó Links de Teste</h3>
                    <div class="space-y-2">
                        <a href="/editor-v1"
                            class="block bg-amber-50 border border-amber-200 rounded-lg p-3 text-amber-800 hover:bg-amber-100 transition-colors">
                            üìù Editor V1 Modular
                        </a>
                        <a href="/"
                            class="block bg-blue-50 border border-blue-200 rounded-lg p-3 text-blue-800 hover:bg-blue-100 transition-colors">
                            üéØ Quiz Principal
                        </a>
                        <a href="/demo-selection-rules.html"
                            class="block bg-green-50 border border-green-200 rounded-lg p-3 text-green-800 hover:bg-green-100 transition-colors">
                            üß™ Demo das Regras
                        </a>
                    </div>
                </div>
            </div>

            <div class="border-t pt-4">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">üîç Resultado da Verifica√ß√£o</h3>
                <div id="verification-result" class="p-4 rounded-lg bg-gray-50 border">
                    <div class="text-center text-gray-500">Clique no bot√£o abaixo para verificar</div>
                </div>

                <div class="flex justify-center mt-4">
                    <button onclick="runFullVerification()"
                        class="bg-amber-500 text-white px-6 py-3 rounded-lg hover:bg-amber-600 transition-colors font-medium">
                        üöÄ Executar Verifica√ß√£o Completa
                    </button>
                </div>
            </div>
        </div>

        <!-- Console de Debug -->
        <div class="bg-gray-900 text-green-400 rounded-lg p-4 font-mono text-sm">
            <div class="font-bold mb-2">üñ•Ô∏è Console de Debug:</div>
            <div id="debug-console">
                <div class="opacity-70">Aguardando verifica√ß√£o...</div>
            </div>
        </div>
    </div>

    <script>
        let verificationResults = {};

        function debugLog(message, type = 'info') {
            const console = document.getElementById('debug-console');
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                info: 'text-green-400',
                success: 'text-emerald-400',
                warning: 'text-yellow-400',
                error: 'text-red-400'
            };

            const logEntry = document.createElement('div');
            logEntry.className = colors[type] || colors.info;
            logEntry.innerHTML = `<span class="opacity-70">[${timestamp}]</span> ${message}`;

            console.appendChild(logEntry);
            console.scrollTop = console.scrollHeight;
        }

        async function checkHybridTemplateService() {
            debugLog('üîß Verificando HybridTemplateService...');

            try {
                // Tentar acessar via window global
                if (window.__HYBRID_TEMPLATE_SERVICE__) {
                    debugLog('‚úÖ Servi√ßo global encontrado');
                    const status = await window.__HYBRID_TEMPLATE_SERVICE__.getStatus();
                    verificationResults.hybridService = status.serviceActive;
                    return true;
                }

                // Tentar via fetch do editor
                const response = await fetch('/editor-v1');
                if (response.ok) {
                    debugLog('‚úÖ Editor V1 acess√≠vel');
                    verificationResults.hybridService = true;
                    return true;
                }

                debugLog('‚ö†Ô∏è HybridTemplateService n√£o verific√°vel via browser', 'warning');
                return false;

            } catch (error) {
                debugLog(`‚ùå Erro ao verificar HybridTemplateService: ${error.message}`, 'error');
                return false;
            }
        }

        function checkImplementedRules() {
            debugLog('üìù Verificando implementa√ß√£o das regras...');

            // Simular verifica√ß√£o das regras implementadas
            const rules = {
                columnDetection: true, // Implementado no OptionsGridBlock.tsx
                goldenBorders: true,   // Implementado com paleta amber
                textOnlyOneColumn: true, // grid-cols-1 quando sem imagens
                imageTextTwoColumns: true, // grid-cols-1 md:grid-cols-2 com imagens
            };

            Object.entries(rules).forEach(([rule, implemented]) => {
                if (implemented) {
                    debugLog(`‚úÖ ${rule}: Implementado`);
                } else {
                    debugLog(`‚ùå ${rule}: N√£o implementado`, 'error');
                }
                verificationResults[rule] = implemented;
            });

            return rules;
        }

        function updateCheckboxes() {
            document.getElementById('check1').checked = verificationResults.hybridService;
            document.getElementById('check2').checked = verificationResults.columnDetection;
            document.getElementById('check3').checked = verificationResults.goldenBorders;
            document.getElementById('check4').checked = verificationResults.textOnlyOneColumn;
            document.getElementById('check5').checked = verificationResults.imageTextTwoColumns;
        }

        function updateVerificationResult() {
            const resultDiv = document.getElementById('verification-result');
            const total = Object.keys(verificationResults).length;
            const passed = Object.values(verificationResults).filter(Boolean).length;

            if (passed === total) {
                resultDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-3xl mb-2">üéâ</div>
                        <div class="text-lg font-bold text-green-700">TODAS AS REGRAS FUNCIONAM!</div>
                        <div class="text-sm text-green-600 mt-2">Verifica√ß√£o: ${passed}/${total} ‚úÖ</div>
                    </div>
                `;
                resultDiv.className = 'p-4 rounded-lg bg-green-50 border border-green-200';
            } else if (passed > 0) {
                resultDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-3xl mb-2">‚ö†Ô∏è</div>
                        <div class="text-lg font-bold text-yellow-700">PARCIALMENTE FUNCIONANDO</div>
                        <div class="text-sm text-yellow-600 mt-2">Verifica√ß√£o: ${passed}/${total}</div>
                    </div>
                `;
                resultDiv.className = 'p-4 rounded-lg bg-yellow-50 border border-yellow-200';
            } else {
                resultDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-3xl mb-2">‚ùå</div>
                        <div class="text-lg font-bold text-red-700">PROBLEMAS DETECTADOS</div>
                        <div class="text-sm text-red-600 mt-2">Verifica√ß√£o: ${passed}/${total}</div>
                    </div>
                `;
                resultDiv.className = 'p-4 rounded-lg bg-red-50 border border-red-200';
            }
        }

        async function runFullVerification() {
            debugLog('üöÄ Iniciando verifica√ß√£o completa...');
            verificationResults = {};

            // Limpar resultado anterior
            document.getElementById('verification-result').innerHTML = '<div class="text-center text-gray-500">Verificando...</div>';

            // Executar verifica√ß√µes
            await checkHybridTemplateService();
            checkImplementedRules();

            // Atualizar UI
            updateCheckboxes();
            updateVerificationResult();

            debugLog('‚úÖ Verifica√ß√£o completa finalizada');

            // Resumo final
            const total = Object.keys(verificationResults).length;
            const passed = Object.values(verificationResults).filter(Boolean).length;

            if (passed === total) {
                debugLog(`üéâ RESULTADO FINAL: TODAS AS REGRAS FUNCIONAM (${passed}/${total})`, 'success');
            } else {
                debugLog(`‚ö†Ô∏è RESULTADO FINAL: ${passed}/${total} regras funcionando`, 'warning');
            }
        }

        // Verifica√ß√£o autom√°tica ao carregar
        document.addEventListener('DOMContentLoaded', () => {
            debugLog('üîç P√°gina de verifica√ß√£o carregada');
            debugLog('üëÜ Clique no bot√£o para executar verifica√ß√£o completa');
        });
    </script>
</body>

</html>