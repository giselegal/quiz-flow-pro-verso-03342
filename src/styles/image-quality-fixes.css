/**
 * üñºÔ∏è OTIMIZA√á√ÉO DE QUALIDADE DE IMAGEM
 * Garante m√°xima nitidez e qualidade visual para imagens no editor
 */

/* ============================================================================
   REGRA #1: Desabilitar acelera√ß√£o GPU que causa blur
   ============================================================================ */
[data-testid="canvas-block"] img,
.intro-logo img,
.intro-image img {
    /* Remover todas as transforma√ß√µes 3D que causam blur */
    transform: none !important;
    will-change: auto !important;

    /* Desabilitar backface-visibility que causa subpixel rendering */
    -webkit-backface-visibility: visible !important;
    backface-visibility: visible !important;

    /* Garantir que imagem n√£o seja composta em camada separada */
    -webkit-transform: translateZ(0) none !important;
}

/* ============================================================================
   REGRA #2: Configurar image-rendering para m√°xima qualidade
   ============================================================================ */
[data-testid="canvas-block"] img {
    /* Ordem de fallback para m√°xima qualidade */
    image-rendering: -webkit-optimize-contrast;
    /* Webkit/Blink */
    image-rendering: -moz-crisp-edges;
    /* Firefox - apenas para √≠cones */
    image-rendering: auto;
    /* Padr√£o - alta qualidade */

    /* Garantir que seja renderizado em tamanho natural */
    image-rendering: high-quality;

    /* Subpixel antialiasing para nitidez */
    -webkit-font-smoothing: subpixel-antialiased;
    -moz-osx-font-smoothing: auto;
}

/* ============================================================================
   REGRA #3: Otimiza√ß√µes espec√≠ficas para Cloudinary
   ============================================================================ */
img[src*="cloudinary"],
img[src*="res.cloudinary.com"] {
    /* Cloudinary j√° entrega imagens otimizadas, deixar browser decidir */
    image-rendering: auto !important;

    /* Garantir que transforma√ß√µes Cloudinary sejam respeitadas */
    object-fit: contain;
    object-position: center;

    /* Remover qualquer filtro ou efeito */
    filter: none !important;
}

/* ============================================================================
   REGRA #4: Prevenir escalonamento incorreto
   ============================================================================ */
[data-testid="canvas-block"] img {
    max-width: 100%;
    height: auto;
    display: block;

    /* Garantir que dimens√µes sejam respeitadas */
    object-fit: contain;

    /* Centralizar na √°rea dispon√≠vel */
    margin: 0 auto;
}

/* ============================================================================
   REGRA #5: Desabilitar otimiza√ß√µes agressivas em modo de edi√ß√£o
   ============================================================================ */
.canvas-column img,
.editor-canvas img {
    /* Priorizar qualidade sobre performance */
    will-change: auto !important;
    contain: none !important;
    content-visibility: auto !important;
}

/* ============================================================================
   REGRA #6: Fix para hover/estados que causam blur
   ============================================================================ */
[data-testid="canvas-block"]:hover img,
[data-testid="canvas-block"].selected img,
[data-testid="canvas-block"]:focus img {
    /* Manter qualidade durante intera√ß√µes */
    transform: none !important;
    filter: none !important;

    /* Apenas destacar com outline, sem transforma√ß√µes */
    outline: none;
}

/* ============================================================================
   REGRA #7: Otimiza√ß√£o para logos (intro-logo)
   ============================================================================ */
.intro-logo-block img,
[data-block-type="intro-logo"] img {
    /* Logos geralmente s√£o PNG com transpar√™ncia */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: auto;

    /* Garantir que transpar√™ncia seja respeitada */
    background: transparent;

    /* Evitar compression artifacts */
    image-rendering: pixelated none;
}

/* ============================================================================
   REGRA #8: Container constraints
   ============================================================================ */
[data-testid="canvas-block"] {
    /* Garantir que container n√£o force escalonamento */
    overflow: visible;

    /* N√£o aplicar transforms no container */
    transform: none !important;
    will-change: auto !important;
}

/* ============================================================================
   REGRA #9: Fix espec√≠fico para flex containers
   ============================================================================ */
.flex.justify-center img {
    /* Evitar que flex shrink force resize */
    flex-shrink: 0;

    /* Manter propor√ß√µes originais */
    aspect-ratio: auto;
}

/* ============================================================================
   REGRA #10: Debugging - Remover em produ√ß√£o
   ============================================================================ */
/* 
[data-testid="canvas-block"] img {
    outline: 1px solid red !important;
    outline-offset: 2px;
}
*/