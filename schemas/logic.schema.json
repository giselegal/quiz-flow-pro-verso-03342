{
	"$schema": "https://json-schema.org/draft/2020-12/schema",
	"$id": "/schemas/logic.schema.json",
	"$comment": "Logic schema - validates conditional logic and rules for quiz flows",
	"title": "Logic Schema",
	"type": "object",
	"additionalProperties": true,
	"properties": {
		"conditions": {
			"type": "array",
			"items": {
				"type": "object",
				"additionalProperties": false,
				"required": ["operator"],
				"properties": {
					"id": {
						"type": "string",
						"pattern": "^[a-zA-Z0-9_-]+$",
						"description": "Condition identifier"
					},
					"left": {
						"description": "Left operand for comparison"
					},
					"operator": {
						"type": "string",
						"enum": ["equals", "notEquals", "greaterThan", "lessThan", "greaterThanOrEqual", "lessThanOrEqual", "contains", "notContains", "startsWith", "endsWith", "matches", "in", "notIn"],
						"description": "Comparison operator"
					},
					"right": {
						"description": "Right operand for comparison"
					}
				}
			},
			"description": "Array of conditions to evaluate"
		},
		"actions": {
			"type": "array",
			"items": {
				"type": "object",
				"additionalProperties": true,
				"required": ["type"],
				"properties": {
					"type": {
						"type": "string",
						"enum": ["navigate", "setVariable", "showBlock", "hideBlock", "submitForm", "triggerEvent", "redirect", "custom"],
						"description": "Action type"
					},
					"params": {
						"type": "object",
						"additionalProperties": true,
						"description": "Action parameters"
					}
				}
			},
			"description": "Array of actions to execute"
		},
		"rules": {
			"type": "array",
			"items": {
				"type": "object",
				"additionalProperties": false,
				"required": ["when", "then"],
				"properties": {
					"id": {
						"type": "string",
						"description": "Rule identifier"
					},
					"when": {
						"type": "string",
						"description": "Condition expression"
					},
					"then": {
						"type": "array",
						"items": { "type": "string" },
						"description": "Actions to execute when condition is met"
					},
					"otherwise": {
						"type": "array",
						"items": { "type": "string" },
						"description": "Actions to execute when condition is not met"
					}
				}
			},
			"description": "Array of conditional rules"
		}
	}
}
